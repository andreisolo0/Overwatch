<div id="page-content">
  
  <h2 class="text-center mt-4"><img src="<%= asset_path('host_icon.png') %>" class="img-fluid mx-auto d-block" width="90" 
    height="80"><%= @host.hostname %></h2>
  
    <div class="container">
      <div class="row justify-content-md-center">
        <div class="col-8 mt-4">
          <div class="card text-center shadow mb-5 bg-white rounded">

            <div class="card-body">
              <div class="card-text text-center font-weight-bold ">IP/FQDN: <%=  @host.ip_address_or_fqdn %> </div>
              <div class="card-text text-center font-weight-bold ">Owned by: <%=  User.find(@host.user_id).username %> </div>

              <div class="card-text text-center ">SSH user to connect: <%=  @host.user_to_connect%> </div>
              <div class="card-text text-center ">SSH port: <%=  @host.ssh_port %> </div>
              <div class="card-text text-center ">Run as sudo: <%=  @host.run_as_sudo %> </div>
              <% if @host.os != nil %>
                <div class="card-text text-center ">Operating system: <%=  @host.os %> </div>
              <% end %>
<!--
              <% actions_array =[] %>
              <% RemoteAction.where(user_id: @host.user_id).ids.each { |n|   actions_array.append(RemoteAction.find(n).action_name) } %>
-->
<!--              <%= form_with(url: apply_remote_action_path(:action_id,:host_id), method: :post, params: {format: @host_id}) do |form| %> 
                            send :id as params and list the name 
                <%= form.select :action_id , RemoteAction.where(user_id: @host.user_id).collect { |p| [  p.action_name , p.id] } %>
                <%= form.submit "Run" %>
              <%end%>
--> 
              <%= form_with url: host_items_path, method: :post do  |form| %> 
                <%= form.select :item_id , (Item.all.collect { |p|
                                                                  [  p.item_name , p.id] 
                                                                } )%>
                  <%= hidden_field_tag(:host_id, @host.id) %>
                  <%= form.submit "Add item" %>
                <%end%>

          <% if @items %>
                <div style="padding-bottom: 10px; padding-top: 10px;">
                  <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                      Item name
                      <span class="badge badge-primary">Last Value</span>
                    </li>
                    <% all_items = Item.all %>
                    <% all_items.each do |item| %>
                      <li class="list-group-item d-flex justify-content-between align-items-center">
                        <%= item.item_name %>
                        <span class="badge badge-info badge-pill"><%= HostItem.where(host_id: @host.id, item_id: item.id).last.value %></span>
                      </li>
                    <% end %>
                  </ul>
                </div>
              <%end%>
              <% if @current_user == User.find(@host.user_id) || @current_user.admin == true %>
                <!-- <%= link_to "Test connection", test_connection_path(@host.id), method: :post, class: "btn btn-outline-info" %> -->
                
                <%= link_to "Edit", edit_host_path(@host), class: "btn btn-outline-info" %>
                <%= link_to "Delete", host_path(@host), class: "btn btn-outline-danger", method: :delete, data: {confirm: "Are you sure?"} %>
              <% end %>
            </div>

            <div class="card-footer text-muted">
              <small>Created <%= time_ago_in_words(@host.created_at) %> ago, 
              edited <%= time_ago_in_words(@host.updated_at) %> ago</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> 